<!DOCTYPE html>
<html>
	<head>
		<title> Heroku Websockets </title>
		<link rel="stylesheet" type="text/css" href="/pages/style.css" />
		<style>
			p {
				color: blue;
				text-align: center;
			}
			
			h1 {
				width: 100%;
				color: red;
				text-align: center;
			}
			
			div{
				padding-left: 10%;
				padding-right: 10%;
				width: 80%;
			}
			
			table{
				width: 100%;	
			}
			
			td{
				width: 50%;
			}
			
			button{
				box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
				width: 250px;
				height: 50px;
				font-size: 20px;
				background-color: white;
				color: black;
				border: 2px solid #4CAF50; /* Green */
			}
		</style>
	</head>
	<body>
		<div>
		<table>
			<tr >
				<td colspan=2"2">
					<h1>Time is shown below </h1>
					<hr>
				</td>
			</tr>
			
			<tr >
				<td colspan=2"2">
					<p id='server-time'></p>
					<hr>
				</td>
			</tr>
			
			<tr >
				<td align="center">
					<button onclick="turnOn()">Turn Light On</button>
					<hr>
				</td>
				<td align="center">
					<button onclick="turnOff()">Turn Light Off</button>
					<hr>
				</td >
			</tr>
		</table>
		</div>
		
		<script >
			var HOST = location.origin.replace(/^https/, 'wss');
			var ws = new WebSocket(HOST);
			var el = document.getElementById('server-time');
			ws.onmessage = function (event) {
				el.innerHTML = 'Server time: ' + event.data;
			};
			function turnOn() {
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open( "GET", "https://dweet.io/dweet/for/home?light=on", false ); // false for synchronous request
				xmlHttp.send( null );			
			}
			
			function turnOff() {
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open( "GET", "https://dweet.io/dweet/for/home?light=off", false ); // false for synchronous request
				xmlHttp.send( null );			
			}
			
		</script>
	</body>
</html>
